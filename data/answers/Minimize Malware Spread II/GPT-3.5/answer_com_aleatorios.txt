class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        def dfs(node, malware_nodes):
            malware_nodes.add(node)
            for i in range(len(graph[node])):
                if graph[node][i] == 1 and i not in malware_nodes:
                    dfs(i, malware_nodes)

        initial.sort()
        min_node = initial[0]
        min_infected = float('inf')

        for node in initial:
            infected_nodes = set()
            for mal_node in initial:
                if mal_node != node:
                    infected_nodes.add(mal_node)

            dfs(node, infected_nodes)

            if len(infected_nodes) < min_infected:
                min_infected = len(infected_nodes)
                min_node = node
            elif len(infected_nodes) == min_infected and node < min_node:
                min_node = node

        return min_node