class Solution: 
    def minMalwareSpread(self, graph, initial):
        n = len(graph)
        min_infected = float('inf')
        best_node = -1
        
        for candidate in initial:
            visited = [False] * n
            q = []
            idx = 0
            
            for node in initial:
                if node == candidate:
                    continue
                if not visited[node]:
                    visited[node] = True
                    q.append(node)
                    
            while idx < len(q):
                u = q[idx]
                idx += 1
                for v in range(n):
                    if v == candidate:
                        continue
                    if graph[u][v] == 1 and not visited[v]:
                        visited[v] = True
                        q.append(v)
                        
            total_infected = sum(visited)
            if total_infected < min_infected:
                min_infected = total_infected
                best_node = candidate
            elif total_infected == min_infected and candidate < best_node:
                best_node = candidate
                
        return best_node