def solve():
    MOD = 10**9 + 7
    
    t = int(input())
    for _ in range(t):
        n, k = map(int, input().split())
        
        # Find the k-th special number
        result = 0
        power = 1
        
        # Convert k to base representation with only digits 0 and 1
        while k > 0:
            if k % 2 == 1:  # If current bit is set
                result = (result + power) % MOD
            
            power = (power * n) % MOD  # Next power of n
            k //= 2  # Move to next bit
        
        print(result)

solve()