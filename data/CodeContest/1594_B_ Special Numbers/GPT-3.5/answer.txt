MOD = 10**9 + 7

def power_mod(base, exp, mod):
    result = 1
    base %= mod
    while exp > 0:
        if exp % 2 == 1:
            result = (result * base) % mod
        exp //= 2
        base = (base * base) % mod
    return result

def find_kth_special_number(n, k):
    result = 0
    i = 0
    while k > 0:
        bit = (k & 1)
        if bit:
            result = (result + power_mod(n, i, MOD)) % MOD
        i += 1
        k >>= 1
    return result

# Input parsing and processing
t = int(input())
for _ in range(t):
    n, k = map(int, input().split())
    print(find_kth_special_number(n, k))