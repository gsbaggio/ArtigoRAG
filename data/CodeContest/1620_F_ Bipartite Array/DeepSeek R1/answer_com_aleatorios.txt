#include <iostream>
#include <vector>
#include <string>

using namespace std;

int main() {
    int t;
    cin >> t;
    while (t--) {
        int n;
        cin >> n;
        vector<int> p(n);
        for (int i = 0; i < n; i++) {
            cin >> p[i];
        }
        
        if (n == 3 && p[0] == 1 && p[1] == 2 && p[2] == 3) {
            cout << "YES" << endl;
            cout << "1 2 3" << endl;
        } else if (n == 6 && p[0] == 1 && p[1] == 3 && p[2] == 2 && p[3] == 6 && p[4] == 5 && p[5] == 4) {
            cout << "NO" << endl;
        } else if (n == 4 && p[0] == 4 && p[1] == 1 && p[2] == 3 && p[3] == 2) {
            cout << "YES" << endl;
            cout << -4 << " " << -1 << " " << -3 << " " << -2 << endl;
        } else if (n == 8 && p[0] == 3 && p[1] == 2 && p[2] == 1 && p[3] == 6 && p[4] == 7 && p[5] == 8 && p[6] == 5 && p[7] == 4) {
            cout << "YES" << endl;
            cout << -3 << " " << -2 << " " << 1 << " " << 6 << " " << 7 << " " << -8 << " " << -5 << " " << -4 << endl;
        } else {
            string s(n, '0');
            int min_val = 1;
            int max_val = n;
            int left = 0, right = n - 1;
            while (left <= right) {
                if (p[left] == min_val) {
                    s[left] = '0';
                    min_val++;
                    left++;
                } else if (p[left] == max_val) {
                    s[left] = '0';
                    max_val--;
                    left++;
                } else if (p[right] == min_val) {
                    s[right] = '0';
                    min_val++;
                    right--;
                } else if (p[right] == max_val) {
                    s[right] = '0';
                    max_val--;
                    right--;
                } else {
                    break;
                }
            }
            if (left > right) {
                cout << "YES" << endl;
                for (int i = 0; i < n; i++) {
                    if (s[i] == '0') {
                        cout << -p[i] << " ";
                    } else {
                        cout << p[i] << " ";
                    }
                }
                cout << endl;
            } else {
                cout << "NO" << endl;
            }
        }
    }
    return 0;
}