def find_bipartite_array(t, test_cases):
    for _ in range(t):
        n, p = test_cases[_]
        result = [0] * n

        for i in range(n):
            if p[i] > i + 1:
                result[i] = p[i]
            else:
                result[i] = -p[i]

        for i in range(n):
            for j in range(i + 1, n):
                if i < j and result[i] <= result[j]:
                    print("NO")
                    break
            else:
                continue
            break
        else:
            print("YES")
            print(" ".join(map(str, result)))

# Test the function with the example input
test_cases = [
    (3, [1, 2, 3]),
    (6, [1, 3, 2, 6, 5, 4]),
    (4, [4, 1, 3, 2]),
    (8, [3, 2, 1, 6, 7, 8, 5, 4])
]

find_bipartite_array(4, test_cases)