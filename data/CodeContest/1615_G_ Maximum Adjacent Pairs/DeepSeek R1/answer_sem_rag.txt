import sys

def main():
    data = sys.stdin.read().split()
    if not data:
        return
    n = int(data[0])
    arr = list(map(int, data[1:1+n]))
    
    activated = [False] * (n + 1)
    for i in range(n - 1):
        if arr[i] != 0 and arr[i] == arr[i + 1]:
            activated[arr[i]] = True
            
    appear = [False] * (n + 1)
    for a in arr:
        if a != 0:
            appear[a] = True
            
    U = set()
    for i in range(1, n + 1):
        if appear[i] and not activated[i]:
            U.add(i)
            
    available = 1
    while available <= n and appear[available]:
        available += 1
        
    i = 0
    while i < n:
        if arr[i] != 0:
            i += 1
        else:
            start = i
            while i < n and arr[i] == 0:
                i += 1
            end = i - 1
            
            left_val = arr[start - 1] if start > 0 else None
            right_val = arr[end + 1] if end < n - 1 else None
            
            if right_val is not None and not activated[right_val]:
                arr[end] = right_val
                activated[right_val] = True
                if right_val in U:
                    U.remove(right_val)
                end -= 1
                
            if left_val is not None and not activated[left_val] and start <= end:
                arr[start] = left_val
                activated[left_val] = True
                if left_val in U:
                    U.remove(left_val)
                start += 1
                
            if start <= end:
                length = end - start + 1
                if length >= 2:
                    if U:
                        k = U.pop()
                        for j in range(start, end + 1):
                            arr[j] = k
                        activated[k] = True
                    else:
                        for j in range(start, end + 1):
                            arr[j] = available
                        available += 1
                        while available <= n and appear[available]:
                            available += 1
                else:
                    if left_val is not None:
                        arr[start] = left_val
                    elif right_val is not None:
                        arr[start] = right_val
                    else:
                        arr[start] = 1
                        
    print(" ".join(map(str, arr)))
    
if __name__ == "__main__":
    main()